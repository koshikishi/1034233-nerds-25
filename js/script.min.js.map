{"version":3,"sources":["script.js"],"names":["contactsLink","document","querySelector","modalContacts","modalContactsClose","contactsForm","userData","name","getElementById","email","message","isStorageSupport","storage","localStorage","getItem","err","addEventListener","evt","preventDefault","modalShow","value","focus","modalClose","setItem","classList","remove","offsetWidth","add","window","keyCode","overlay","sliderDots","querySelectorAll","slides","sliderDotActive","slideActive","addDotClickHandler","sliderDot","slide","i","length","slider","rangeWidth","sliderIndent","thumbHalfWidth","price","min","max","thumbs","isDragging","track","inputs","rangeRatio","currentPrice","moveLeftThumb","moveRightThumb","Math","round","mousePosX","Number","initMap","map","google","maps","Map","zoom","center","lat","lng","disableDefaultUI","Marker","position","icon","elmt","modalShown","contains","minPrice","style","left","maxPrice","right","x","clientX","getBoundingClientRect"],"mappings":"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","file":"script.min.js","sourcesContent":["'use strict';\n\n// Оживление всплывающего окна формы обратной связи\nvar contactsLink = document.querySelector('.contacts__button');\n\nvar modalContacts = document.querySelector('.modal--contacts');\n\nif (modalContacts) {\n  var modalContactsClose = modalContacts.querySelector('.modal__close');\n\n  var contactsForm = modalContacts.querySelector('.contacts-form');\n  var userData = {\n    name: document.getElementById('contacts-name'),\n    email: document.getElementById('contacts-email'),\n    message: document.getElementById('contacts-message')\n  };\n\n  var isStorageSupport = true;\n  var storage = {\n    name: '',\n    email: ''\n  };\n\n  // Проверка, работает ли localStorage\n  try {\n    storage.name = localStorage.getItem('name');\n    storage.email = localStorage.getItem('email');\n  } catch (err) {\n    isStorageSupport = false;\n  }\n\n  // Появление всплывающего окна\n  contactsLink.addEventListener('click', function (evt) {\n    evt.preventDefault();\n    modalShow(modalContacts);\n\n    if (storage.name && storage.email) {\n      userData.name.value = storage.name;\n      userData.email.value = storage.email;\n      userData.message.focus();\n    } else {\n      userData.name.focus();\n    }\n  });\n\n  // Закрытие всплывающего окна\n  modalContactsClose.addEventListener('click', function (evt) {\n    evt.preventDefault();\n    modalClose();\n  });\n\n  // Сохранеие данных пользователя в localStorage\n  contactsForm.addEventListener('submit', function (evt) {\n    if (!userData.name.value || !userData.email.value || !userData.message.value) {\n      evt.preventDefault();\n      modalContacts.classList.remove('modal--error');\n      void modalContacts.offsetWidth;\n      modalContacts.classList.add('modal--error');\n\n      if (!userData.name.value) {\n        userData.name.focus();\n      } else if (!userData.email.value) {\n        userData.email.focus();\n      } else {\n        userData.message.focus();\n      }\n    } else if (isStorageSupport) {\n      localStorage.setItem('name', userData.name.value);\n      localStorage.setItem('email', userData.email.value);\n    }\n  });\n}\n\n// Закрытие всплывающего окна по нажатию Esc\nwindow.addEventListener('keydown', function (evt) {\n  if (evt.keyCode === 27) {\n    evt.preventDefault();\n    modalClose();\n  }\n});\n\n// Закрытие всплывающего окна по клику вне окна\nvar overlay = document.querySelector('.overlay');\n\noverlay.addEventListener('click', function () {\n  modalClose();\n});\n\n// Оживление слайдера\nvar sliderDots = document.querySelectorAll('.slider__indicator');\nvar slides = document.querySelectorAll('.slider__item');\n\nvar sliderDotActive = document.querySelector('.slider__indicator--active');\nvar slideActive = document.querySelector('.slider__item--active');\n\nvar addDotClickHandler = function (sliderDot, slide) {\n  sliderDot.addEventListener('click', function (evt) {\n    evt.preventDefault();\n    if (sliderDot !== sliderDotActive) {\n      sliderDotActive.classList.remove('slider__indicator--active');\n      slideActive.classList.remove('slider__item--active');\n\n      sliderDot.classList.add('slider__indicator--active');\n      slide.classList.add('slider__item--active');\n\n      sliderDotActive = sliderDot;\n      slideActive = slide;\n    }\n  });\n};\n\nfor (var i = 0; i < sliderDots.length; i++) {\n  addDotClickHandler(sliderDots[i], slides[i]);\n}\n\n// Оживление ползунков фильтра цены\nvar slider = document.querySelector('.filters-form__slider');\n\nif (slider) {\n  var rangeWidth = 200;\n  var sliderIndent = 20;\n  var thumbHalfWidth = 10;\n  var price = {\n    min: 0,\n    max: 21429\n  };\n\n  // Установка тумблерам флага \"перетаскиваемый\" при нажатии на них кнопки мыши\n  var thumbs = slider.querySelectorAll('.filters-form__thumb');\n  var isDragging = [false, false];\n\n  thumbs[0].addEventListener('mousedown', function () {\n    isDragging[0] = true;\n  });\n  thumbs[1].addEventListener('mousedown', function () {\n    isDragging[1] = true;\n  });\n  slider.addEventListener('mouseup', function () {\n    isDragging = [false, false];\n  });\n\n  // Установка начального положения тумблеров в зависимости от значений цены\n  var track = slider.querySelector('.filters-form__track');\n  var inputs = document.querySelectorAll('.filters-form__price input');\n\n  var rangeRatio = rangeWidth / (price.max - price.min);\n  var currentPrice = {\n    min: inputs[0].value,\n    max: inputs[1].value\n  };\n\n  moveLeftThumb(currentPrice.min);\n  moveRightThumb(currentPrice.max);\n\n  // Вычисление для перетаскиваемого тумблера нового значения цены и положения на слайдере\n  slider.addEventListener('mousemove', function (evt) {\n    if (isDragging[0]) {\n      currentPrice.min = Math.round(mousePosX(slider, evt) / rangeRatio) + price.min;\n\n      if (currentPrice.min < currentPrice.max && currentPrice.min >= price.min) {\n        moveLeftThumb(currentPrice.min);\n        inputs[0].value = currentPrice.min;\n      }\n    }\n    if (isDragging[1]) {\n      currentPrice.max = Math.round(mousePosX(slider, evt) / rangeRatio) + price.min;\n\n      if (currentPrice.max > currentPrice.min && currentPrice.max <= price.max) {\n        moveRightThumb(currentPrice.max);\n        inputs[1].value = currentPrice.max;\n      }\n    }\n  });\n\n  // Вычисление нового положения тумблеров при изменении значений в полях ввода\n  inputs[0].addEventListener('blur', function () {\n    if (inputs[0].value !== currentPrice.min) {\n      if (inputs[0].value < price.min) {\n        inputs[0].value = price.min;\n      } else if (Number(inputs[0].value) >= currentPrice.max) {\n        inputs[0].value = currentPrice.max - 1;\n      }\n\n      currentPrice.min = inputs[0].value;\n      moveLeftThumb(currentPrice.min);\n    }\n  });\n  inputs[1].addEventListener('blur', function () {\n    if (inputs[1].value !== currentPrice.max) {\n      if (inputs[1].value > price.max) {\n        inputs[1].value = price.max;\n      } else if (inputs[1].value <= Number(currentPrice.min)) {\n        inputs[1].value = Number(currentPrice.min) + 1;\n      }\n\n      currentPrice.max = inputs[1].value;\n      moveRightThumb(currentPrice.max);\n    }\n  });\n}\n\n// Инициализация интерактивной карты\nfunction initMap() {\n  var mapCoordinates = {\n    lat: 59.939105,\n    lng: 30.321487\n  };\n\n  var map = new google.maps.Map(document.querySelector('.contacts__map'), {\n    zoom: 17,\n    center: mapCoordinates,\n    disableDefaultUI: true\n  });\n\n  var markerCoordinates = {\n    lat: 59.938723,\n    lng: 30.323789\n  };\n  var icon = 'img/map-marker.png';\n\n  var marker = new google.maps.Marker({\n    position: markerCoordinates,\n    map: map,\n    icon: icon\n  });\n}\n\n// Появление всплывающего окна\nfunction modalShow(elmt) {\n  elmt.classList.add('modal--shown');\n  overlay.classList.add('overlay--shown');\n}\n\n// Закрытие всплывающего окна\nfunction modalClose() {\n  var modalShown = document.querySelector('.modal--shown');\n\n  if (modalShown) {\n    modalShown.classList.remove('modal--shown');\n    overlay.classList.remove('overlay--shown');\n\n    if (modalShown.classList.contains('modal--error')) {\n      modalShown.classList.remove('modal--error');\n    }\n  }\n}\n\n// Перемещение тумблеров в зависимости от цены\nfunction moveLeftThumb(minPrice) {\n  thumbs[0].style.left = (minPrice - price.min) * rangeRatio + sliderIndent + 'px';\n  track.style.left = (minPrice - price.min) * rangeRatio + thumbHalfWidth + 'px';\n}\n\nfunction moveRightThumb(maxPrice) {\n  thumbs[1].style.right = (price.max - maxPrice) * rangeRatio + sliderIndent + 'px';\n  track.style.right = (price.max - maxPrice) * rangeRatio + thumbHalfWidth + 'px';\n}\n\n// Вычисление координаты X курсора относительно полоски слайдера,\n// учитывая отступы от краёв контейнера и ширину тумблеров\nfunction mousePosX(elmt, evt) {\n  var x = Math.round(evt.clientX - elmt.getBoundingClientRect().left) - (sliderIndent + thumbHalfWidth);\n\n  if (x < 0) {\n    return 0;\n  }\n  if (x > rangeWidth) {\n    return rangeWidth;\n  }\n\n  return x;\n}\n"]}